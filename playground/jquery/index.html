<!DOCTYPE html>
<html>

<head>
    <title>DevExtreme jQuery Example</title>

    <link href="https://cdn3.devexpress.com/jslib/20.1.6/css/dx.common.css" rel="stylesheet">
    <link href="https://cdn3.devexpress.com/jslib/20.1.6/css/dx.light.css" rel="stylesheet">
    <script type="text/javascript" src="../../devextreme/artifacts/js/jquery.js"></script>

    <script type="text/javascript" src="../../bundles/jquery/button-basic.js" charset="utf-8"></script>
    <!-- <script type="text/javascript" src="../../bundles/jquery/button-renovated.js" charset="utf-8"></script> -->

    <!-- <script type="text/javascript" src="../../bundles/jquery/check_box-basic.js" charset="utf-8"></script> -->
    <script type="text/javascript" src="../../bundles/jquery/check_box-renovated.js" charset="utf-8"></script>
</head>

<body>
    <div id="button"></div>
    <div id="checkbox"></div>
    <script>
        // Initial rendering
        let buttons = [];
        const count = 5000;
        let index = 0;
        const contentReady = () => {
            index += 1;

            if (index === count) {
                console.timeEnd('First render (min options, content ready)');
            }
        };

        const prepareWorkspace = () => {
            document.body.innerHTML = '';
            for (var i = 0; i < count; i++) {
                const el = document.createElement('div');
                el.id = i;
                document.body.appendChild(el);
            }
        }

        console.log('startMemory');
        console.log(window.performance.memory);

        prepareWorkspace();
        console.time('First render (maximum options)');

        for (var i = 0; i < count; i++) {
            $('#' + i).dxButton({
                onContentReady: () => undefined,
                text: 'button',
                icon: 'download',
                accessKey: 'c',
                activeStateEnabled: true,
                disabled: false,
                elementAttr: { 'data-fake': 123 },
                hint: 'text hint',
                onClick: () => undefined,
                rtlEnabled: true,
                tabIndex: 1,
                width: 100,
                height: '40'
            });
        }
        console.timeEnd('First render (maximum options)');


        prepareWorkspace();
        console.time('First render (with template)');

        for (var i = 0; i < count; i++) {
            $('#' + i).dxButton({
                text: 'button',
                template: function () {
                    return $("<div>").text("Button Template");
                }
            });
        }

        console.timeEnd('First render (with template)')


        prepareWorkspace();
        buttons = [];
        for (var i = 0; i < count; i++) {
            buttons.push($('#' + i).dxButton({ text: 'button' }).dxButton('instance'));
        }
        
        console.time('Rerender (Icon option change)');
        buttons.forEach((button) => {
            button.option({ icon: 'download' });
        });

        console.timeEnd('Rerender (Icon option change)');


        prepareWorkspace();
        buttons = [];
        for (var i = 0; i < count; i++) {
            buttons.push($('#' + i).dxButton({ text: 'button' }).dxButton('instance'));
        }
        
        console.time('Rerender (Text option change)');
        buttons.forEach((button) => {
            button.option({ text: 'New Button Text' });
        });

        console.timeEnd('Rerender (Text option change)');



        prepareWorkspace();
        buttons = [];
        for (var i = 0; i < count; i++) {
            buttons.push($('#' + i).dxButton({ text: 'button' }).dxButton('instance'));
        }
        
        console.time('Rerender (useInkRipple option change)');
        buttons.forEach((button) => {
            button.option({ useInkRipple: true });
        });

        console.timeEnd('Rerender (useInkRipple option change)');
        
        
        
        prepareWorkspace();
        buttons = [];
        for (var i = 0; i < count; i++) {
            buttons.push($('#' + i).dxButton({ text: 'button' }).dxButton('instance'));
        }
        
        console.time('Rerender (onFocus)');
        buttons.forEach((button) => {
            button.focus();
        });

        console.timeEnd('Rerender (onFocus)');



        prepareWorkspace();
        buttons = [];
        index = 0;
        for (var i = 0; i < count; i++) {
            buttons.push($('#' + i).dxButton({
                text: 'button',
                onClick: () => {
                    index += 1;

                    if (index === count) {
                        console.timeEnd('Rerender (Click)');
                    }
                },
            }).dxButton('instance'));
        }
        
        console.time('Rerender (Click)');
        buttons.forEach((button, i) => {
            $('#' + i).click();
        });


        prepareWorkspace();
        index = 0;
        console.time('First render (min options)');
        console.time('First render (min options, content ready)');

        for (var i = 0; i < count; i++) {
            $('#' + i).dxButton({ onContentReady: contentReady, text: 'button' });
        }

        console.timeEnd('First render (min options)');

        prepareWorkspace();

        console.log('endMemory');
        console.log(window.performance.memory);

        // // Change option

        // document.body.innerHTML = '';

        // console.time('Change option: \'text\'');
        // const el = document.createElement('div');
        // document.body.appendChild(el);
        // const button = new dxButton(el, {});
        // for (var i = 0; i < count; i++) {
        //     button.option('text', String(i));
        // }
        // console.timeEnd('Change option: \'text\'');

        // console.time('Change option: \'useSubmitBehavior\' (invalidate)');
        // for (var i = 0; i < count; i++) {
        //     button.option('useSubmitBehavior', !button.option('useSubmitBehavior'));
        // }
        // console.timeEnd('Change option: \'useSubmitBehavior\' (invalidate)');
    </script>
</body>

</html>